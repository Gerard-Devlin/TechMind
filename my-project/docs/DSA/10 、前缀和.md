<h1>
    å‰ç¼€å’Œ
</h1>

[TOC]

---

## ä¸€ã€è§£é‡Š

```c++
// åŸå§‹æ•°ç»„ï¼š
coins[] = {0, 3, 5, 2, 1, 4}

// å‰ç¼€å’Œè®¡ç®—è¿‡ç¨‹ï¼š
prefix[1] = prefix[0] + coins[1] = 0 + 3 = 3
prefix[2] = prefix[1] + coins[2] = 3 + 5 = 8
prefix[3] = prefix[2] + coins[3] = 8 + 2 = 10
prefix[4] = prefix[3] + coins[4] = 10 + 1 = 11
prefix[5] = prefix[4] + coins[5] = 11 + 4 = 15

// æ±‚åŒºé—´[L,R]çš„å’Œçš„å…¬å¼ï¼š
sum = prefix[R] - prefix[L-1]

//ä¾‹å¦‚æ±‚[2,4]çš„å’Œï¼š
sum = prefix[4] - prefix[1] = 11 - 3 = 8
```

## äºŒã€ä¸€ç»´å‰ç¼€å’Œ

```c++
// ä¸€ç»´å‰ç¼€å’Œçš„æ ‡å‡†æ¨¡æ¿
const int N = 100010;
int a[N];     // åŸå§‹æ•°ç»„
int s[N];     // å‰ç¼€å’Œæ•°ç»„
int n;        // æ•°ç»„é•¿åº¦

// 1. æ„å»ºå‰ç¼€å’Œ
s[0] = 0;  // åˆå§‹åŒ–ï¼Œé˜²æ­¢è¶Šç•Œï¼ˆé‡è¦ï¼ï¼‰
for(int i = 1; i <= n; i++) {
    s[i] = s[i-1] + a[i];
}

// 2. åŒºé—´å’ŒæŸ¥è¯¢
// æŸ¥è¯¢åŒºé—´[l,r]çš„å’Œ
int query(int l, int r) {
    return s[r] - s[l-1];
}
```

!!! tip
	ç”¨æ¥è®¡ç®—**è¿ç»­**æ•°å­—çš„å’ŒğŸ‘‰æé«˜æ•ˆç‡

## ä¸‰ã€äºŒç»´å‰ç¼€å’Œ
![prefix-sum-2d.svg](../assets/images/DSA/prefix-sum-2d.svg)

```c++
// äºŒç»´å‰ç¼€å’Œæ¨¡æ¿
const int N = 1010;
int a[N][N];    // åŸå§‹æ•°ç»„
int s[N][N];    // å‰ç¼€å’Œæ•°ç»„

// æ„å»ºäºŒç»´å‰ç¼€å’Œ
void init(int n, int m) {
    for(int i = 1; i <= n; i++) {
        for(int j = 1; j <= m; j++) {
            s[i][j] = s[i-1][j] + s[i][j-1] - s[i-1][j-1] + a[i][j];
        }
    }
}

// æŸ¥è¯¢å­çŸ©é˜µå’Œ (x1,y1)åˆ°(x2,y2)
int query(int x1, int y1, int x2, int y2) {
    return s[x2][y2] - s[x2][y1-1] - s[x1-1][y2] + s[x1-1][y1-1];
}
```

---

## ä¾‹é¢˜

### e.g.18ã€æ·±è¿›1.ä¾‹1ã€‘æ±‚åŒºé—´å’Œ

é¢˜ç›®æè¿°

ç»™å®š $n$ ä¸ªæ­£æ•´æ•°ç»„æˆçš„æ•°åˆ— $a_1, a_2, \cdots, a_n$ å’Œ $m$ ä¸ªåŒºé—´ $[l_i,r_i]$ï¼Œåˆ†åˆ«æ±‚è¿™ $m$ ä¸ªåŒºé—´çš„åŒºé—´å’Œã€‚

å¯¹äºæ‰€æœ‰æµ‹è¯•æ•°æ®ï¼Œ$n,m\le10^5,a_i\le 10^4$

è¾“å…¥æ ¼å¼

ç¬¬ä¸€è¡Œï¼Œä¸ºä¸€ä¸ªæ­£æ•´æ•° $n$ ã€‚

ç¬¬äºŒè¡Œï¼Œä¸º $n$ ä¸ªæ­£æ•´æ•° $a_1,a_2, \cdots ,a_n$

ç¬¬ä¸‰è¡Œï¼Œä¸ºä¸€ä¸ªæ­£æ•´æ•° $m$ ã€‚

æ¥ä¸‹æ¥ $m$ è¡Œï¼Œæ¯è¡Œä¸ºä¸¤ä¸ªæ­£æ•´æ•° $l_i,r_i$ ï¼Œæ»¡è¶³$1\le l_i\le r_i\le n$

è¾“å‡ºæ ¼å¼

å…± $m$ è¡Œã€‚

ç¬¬ $i$ è¡Œä¸ºç¬¬ $i$ ç»„ç­”æ¡ˆçš„è¯¢é—®ã€‚

æ ·ä¾‹ 

æ ·ä¾‹è¾“å…¥ 

```
4
4 3 2 1
2
1 4
2 3
```

æ ·ä¾‹è¾“å‡º 

```
10
5
```

æç¤º

æ ·ä¾‹è§£é‡Šï¼šç¬¬ $1$ åˆ°ç¬¬ $4$ ä¸ªæ•°åŠ èµ·æ¥å’Œä¸º $10$ã€‚ç¬¬ $2$ ä¸ªæ•°åˆ°ç¬¬ $3$ ä¸ªæ•°åŠ èµ·æ¥å’Œä¸º $5$ã€‚

å¯¹äº $50 \%$ çš„æ•°æ®ï¼š$n,m\le 1000$ï¼›

å¯¹äº $100 \%$ çš„æ•°æ®ï¼š$1 \le n, m\le 10^5$ï¼Œ$1 \le a_i\le 10^4$

```c++
#include <bits/stdc++.h>
using namespace std;
int main() {
    int n, m;
    cin >> n;
    int arr[100000];
    int s[100000];
    for (int i = 1; i <= n; i++) {
        cin >> arr[i];
    }
    for (int i = 1; i <= n; i++) {
        s[i] = s[i - 1] + arr[i]; // å‰ç¼€å’Œ
    }
    cin >> m;
    while (m--) {
        int l, r;
        cin >> l >> r;
        cout << s[r] - s[l - 1] << endl;
    }
    return 0;
}
```

---

### e.g.19 [è“æ¡¥æ¯ 2022 çœ A] æ±‚å’Œ

é¢˜ç›®æè¿°

ç»™å®š $n$ ä¸ªæ•´æ•° $a_{1}, a_{2}, \cdots, a_{n}$, æ±‚å®ƒä»¬ä¸¤ä¸¤ç›¸ä¹˜å†ç›¸åŠ çš„å’Œï¼Œå³

$$
S=a_{1} \cdot a_{2}+a_{1} \cdot a_{3}+\cdots+a_{1} \cdot a_{n}+a_{2} \cdot a_{3}+\cdots+a_{n-2} \cdot a_{n-1}+a_{n-2} \cdot a_{n}+a_{n-1} \cdot a_{n}
$$

è¾“å…¥æ ¼å¼

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° $n$ ã€‚

ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•° $a_{1}, a_{2}, \cdots a_{n}$ ã€‚

è¾“å‡ºæ ¼å¼

è¾“å‡ºä¸€ä¸ªæ•´æ•° $S$ï¼Œè¡¨ç¤ºæ‰€æ±‚çš„å’Œã€‚è¯·ä½¿ç”¨åˆé€‚çš„æ•°æ®ç±»å‹è¿›è¡Œè¿ç®—ã€‚

æ ·ä¾‹ 

æ ·ä¾‹è¾“å…¥ 

```
4
1 3 6 9
```

æ ·ä¾‹è¾“å‡º 

```
117
```

æç¤º

å¯¹äº $30 \%$ çš„æ•°æ®, $1 \leq n \leq 1000,1 \leq a_{i} \leq 100$ ã€‚

å¯¹äºæ‰€æœ‰è¯„æµ‹ç”¨ä¾‹, $1 \leq n \leq 2\times10^5,1 \leq a_{i} \leq 1000$ ã€‚ 

è“æ¡¥æ¯ 2022 çœèµ› A ç»„ C é¢˜ã€‚

```c++
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
ll n, ans, a[1000000], s[1000000];
int main() {
    int n;
    cin >> n;
    for (int i = 1; i <= n; i++) {
        cin >> a[i];
    }
    for (int i = 1; i <= n; i++) { // å¾ªç¯è®¡ç®—å‰ç¼€å’Œ
        s[i] = s[i - 1] + a[i];    // å‰ç¼€å’Œs[i]æ˜¯å½“å‰å…ƒç´ a[i]åŠ ä¸Šå‰ä¸€ä¸ªå‰ç¼€å’Œs[i-1]
    }
    for (int i = 1; i <= n; i++) {   // å¾ªç¯è®¡ç®—æœ€ç»ˆç»“æœ
        ans += a[i] * (s[n] - s[i]); // å¯¹äºæ¯ä¸ªå…ƒç´ a[i]ï¼Œè®¡ç®—å…¶ä¸å‰©ä½™æ‰€æœ‰å…ƒç´ çš„å’Œçš„ä¹˜ç§¯ï¼Œç´¯åŠ åˆ°ans
    }
    cout << ans;
}
```

---

### e.g.20 å¯è·å¾—çš„æœ€å°å€¼

é—®é¢˜æè¿°

å¦®å¦®å­¦å§æ‰‹å¤´æœ‰ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°ç»„ $a$ï¼Œå¥¹æƒ³è¿›è¡Œ $k$ æ¬¡æ“ä½œæ¥å–å‡ºæ•°ç»„ä¸­çš„å…ƒç´ ã€‚æ¯æ¬¡æ“ä½œå¿…é¡»é€‰æ‹©ä»¥ä¸‹ä¸¤ç§æ“ä½œä¹‹ä¸€ï¼š

- å–å‡ºæ•°ç»„ä¸­çš„æœ€å¤§å…ƒç´ ã€‚
- å–å‡ºæ•°ç»„ä¸­çš„æœ€å°å…ƒç´ å’Œæ¬¡å°å…ƒç´ ã€‚

å¦®å¦®å­¦å§å¸Œæœ›åœ¨è¿›è¡Œå®Œ $k$ æ¬¡æ“ä½œåï¼Œå–å‡ºçš„æ•°çš„å’Œæœ€å°ã€‚å¥¹æ„Ÿè§‰æœ‰äº›å›°éš¾ï¼Œäºæ˜¯è¯·æ“…é•¿è´ªå¿ƒçš„ä½ å¸®åŠ©å¥¹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

è¾“å…¥æ ¼å¼

ç¬¬ä¸€è¡Œè¾“å…¥ä¸¤ä¸ªæ•´æ•°$n$å’Œ$k$ ï¼Œè¡¨ç¤ºæ•°ç»„é•¿åº¦å’Œæ“ä½œæ¬¡æ•°ã€‚

ç¬¬äºŒè¡Œè¾“å…¥$n$ä¸ªæ•´æ•°è¡¨ç¤ºæ•°ç»„ $a$ ã€‚

æ•°æ®èŒƒå›´ä¿è¯ $3â‰¤nâ‰¤2Ã—10^5ï¼Œ1â‰¤a_iâ‰¤10^9ï¼Œ1â‰¤kâ‰¤99999ï¼Œ2k<n$ ã€‚

è¾“å‡ºæ ¼å¼

æ ·ä¾‹è¾“å…¥

```
5 1
2 5 1 10 6
```

æ ·ä¾‹è¾“å‡º

```
3
```

è¯´æ˜

å¯¹äºæ ·ä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡æ“ä½œ $2$å–å‡º $1$ å’Œ $2$ å¯ä»¥è·å¾—æœ€å°å€¼

```c++
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 2e5 + 10;
ll n, k, ans, a[N], s[N];
int main() {
    cin >> n >> k;
    for (int i = 1; i <= n; i++)
        cin >> a[i];
    sort(a + 1, a + 1 + n);
    for (int i = 1; i <= n; i++)
        s[i] = s[i - 1] + a[i];
    ll ans = 1e18;
    for (int i = 0; i <= k; i++)
        ans = min(ans, s[n] - s[n - i] + s[2 * k - 2 * i]);
    cout << ans << endl;
    return 0;
}
```

---

### e.g.21 [è“æ¡¥æ¯ 2024 çœ A] è®­ç»ƒå£«å…µ

é¢˜ç›®æè¿°

åœ¨è“æ¡¥ç‹å›½ä¸­ï¼Œæœ‰ $n$ åå£«å…µï¼Œè¿™äº›å£«å…µéœ€è¦æ¥å—ä¸€ç³»åˆ—ç‰¹æ®Šçš„è®­ç»ƒï¼Œä»¥æå‡ä»–ä»¬çš„æˆ˜æ–—æŠ€èƒ½ã€‚å¯¹äºç¬¬ $i$ åå£«å…µæ¥è¯´ï¼Œè¿›è¡Œä¸€æ¬¡è®­ç»ƒæ‰€éœ€çš„æˆæœ¬ä¸º $p_i$ æšé‡‘å¸ï¼Œè€Œè¦æƒ³æˆä¸ºé¡¶å°–æˆ˜å£«ï¼Œä»–è‡³å°‘éœ€è¦è¿›è¡Œ $c_i$ æ¬¡è®­ç»ƒã€‚  
ä¸ºäº†ç¡®ä¿è®­ç»ƒçš„é«˜æ•ˆæ€§ï¼Œç‹å›½æ¨å‡ºäº†ä¸€ç§ç»„å›¢è®­ç»ƒçš„æ–¹æ¡ˆã€‚è¯¥æ–¹æ¡ˆåŒ…å«æ¯ä½å£«å…µæ‰€éœ€çš„ä¸€æ¬¡è®­ç»ƒï¼Œä¸”æ€»å…±åªéœ€æ”¯ä»˜ $S$ æšé‡‘å¸ï¼ˆç»„å›¢è®­ç»ƒæ–¹æ¡ˆå¯ä»¥å¤šæ¬¡è´­ä¹°ï¼Œå³å£«å…µå¯ä»¥è¿›è¡Œå¤šæ¬¡ç»„å›¢è®­ç»ƒï¼‰ã€‚  
ä½œä¸ºè®­ç»ƒæŒ‡æŒ¥å®˜ï¼Œè¯·ä½ è®¡ç®—å‡ºæœ€å°‘éœ€è¦èŠ±è´¹å¤šå°‘é‡‘å¸ï¼Œæ‰èƒ½ä½¿å¾—æ‰€æœ‰çš„å£«å…µéƒ½æˆä¸ºé¡¶å°–æˆ˜å£«ï¼Ÿ

è¾“å…¥æ ¼å¼

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $S$ï¼Œç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ï¼Œè¡¨ç¤ºå£«å…µçš„æ•°é‡å’Œè¿›è¡Œä¸€æ¬¡ç»„å›¢è®­ç»ƒæ‰€éœ€çš„é‡‘å¸æ•°ã€‚  
æ¥ä¸‹æ¥çš„ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $p_i$ å’Œ $c_i$ï¼Œç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ï¼Œè¡¨ç¤ºç¬¬ $i$ åå£«å…µè¿›è¡Œä¸€æ¬¡è®­ç»ƒçš„é‡‘å¸æˆæœ¬å’Œè¦æˆä¸ºé¡¶å°–æˆ˜å£«æ‰€éœ€çš„è®­ç»ƒæ¬¡æ•°ã€‚

è¾“å‡ºæ ¼å¼

è¾“å‡ºä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä½¿æ‰€æœ‰å£«å…µæˆä¸ºé¡¶å°–æˆ˜å£«æ‰€éœ€çš„æœ€å°‘é‡‘å¸æ•°ã€‚

æ ·ä¾‹ 

æ ·ä¾‹è¾“å…¥ 

```
3 6
5 2
2 4
3 2
```

æ ·ä¾‹è¾“å‡º 

```
16
```

æç¤º

èŠ±è´¹é‡‘å¸æœ€å°‘çš„è®­ç»ƒæ–¹å¼ä¸ºï¼šè¿›è¡Œ $2$ æ¬¡ç»„å›¢è®­ç»ƒï¼ŒèŠ±è´¹ $2 Ã— 6 = 12$ æšé‡‘å¸ï¼Œæ­¤æ—¶å£«å…µ $1, 3$ å·²æˆä¸ºé¡¶å°–æˆ˜å£«ï¼›å†èŠ±è´¹ $4$ æšé‡‘å¸ï¼Œè®©å£«å…µ $2$ è¿›è¡Œä¸¤æ¬¡è®­ç»ƒï¼Œæˆä¸ºé¡¶å°–æˆ˜å£«ã€‚æ€»èŠ±è´¹ä¸º $12 + 4 = 16$ã€‚

å¯¹äº $40\%$ çš„è¯„æµ‹ç”¨ä¾‹ï¼Œ$1 â‰¤ n â‰¤ 10^3ï¼Œ1 â‰¤ p_i
, c_i â‰¤ 10^5ï¼Œ1 â‰¤ S â‰¤ 10^7$ã€‚

å¯¹äºæ‰€æœ‰è¯„æµ‹ç”¨ä¾‹ï¼Œ$1 â‰¤ n â‰¤ 10^5ï¼Œ1 â‰¤ p_i
, c_i â‰¤ 10^6ï¼Œ1 â‰¤ S â‰¤ 10^{10}$ã€‚

---

### e.g.22 é¢†åœ°é€‰æ‹©

é¢˜ç›®æè¿°

ä½œä¸ºåœ¨è™šæ‹Ÿä¸–ç•Œé‡Œç»Ÿå¸…åƒå†›ä¸‡é©¬çš„é¢†è¢–ï¼Œå° Z è®¤ä¸ºå¤©æ—¶ã€åœ°åˆ©ã€äººå’Œä¸‰è€…æ˜¯ç¼ºä¸€ä¸å¯çš„ï¼Œæ‰€ä»¥ï¼Œè°¨æ…åœ°é€‰æ‹©é¦–éƒ½çš„ä½ç½®å¯¹äºå° Z æ¥è¯´æ˜¯éå¸¸é‡è¦çš„ã€‚

é¦–éƒ½è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå åœ° $C\times C$ çš„æ­£æ–¹å½¢ã€‚å° Z å¸Œæœ›ä½ å¯»æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ä½ç½®ï¼Œä½¿å¾—é¦–éƒ½æ‰€å é¢†çš„ä½ç½®çš„åœŸåœ°ä»·å€¼å’Œæœ€é«˜ã€‚

è¾“å…¥æ ¼å¼

ç¬¬ä¸€è¡Œä¸‰ä¸ªæ•´æ•° $N,M,C$ï¼Œè¡¨ç¤ºåœ°å›¾çš„å®½å’Œé•¿ä»¥åŠé¦–éƒ½çš„è¾¹é•¿ã€‚

æ¥ä¸‹æ¥ $N$ è¡Œæ¯è¡Œ $M$ ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºäº†åœ°å›¾ä¸Šæ¯ä¸ªåœ°å—çš„ä»·å€¼ã€‚ä»·å€¼å¯èƒ½ä¸ºè´Ÿæ•°ã€‚

è¾“å‡ºæ ¼å¼

ä¸€è¡Œä¸¤ä¸ªæ•´æ•° $X,Y$ï¼Œè¡¨ç¤ºé¦–éƒ½å·¦ä¸Šè§’çš„åæ ‡ã€‚

æ ·ä¾‹ 

æ ·ä¾‹è¾“å…¥ 

```
3 4 2
1 2 3 1
-1 9 0 2
2 0 1 1
```

æ ·ä¾‹è¾“å‡º 

```
1 2
```

æç¤º

å¯¹äº $60\%$ çš„æ•°æ®ï¼Œ$N,M\le 50$ã€‚

å¯¹äº $90\%$ çš„æ•°æ®ï¼Œ$N,M\le 300$ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1\le N,M\le 10^3$ï¼Œ$1\le C\le \min(N,M)$ã€‚

```c++
#include <bits/stdc++.h>
using namespace std;
const int n = 1005;
int N, M, C, a[n][n], s[n][n], ansX, ansY;
int main() {
    cin >> N >> M >> C;
    for (int i = 1; i <= N; i++) {
        for (int j = 1; j <= M; j++) {
            cin >> a[i][j];
        }
    }
    // æ„å»ºäºŒç»´å‰ç¼€å’Œ
    for (int i = 1; i <= N; i++) {
        for (int j = 1; j <= M; j++) {
            s[i][j] = s[i - 1][j] + s[i][j - 1] - s[i - 1][j - 1] + a[i][j];
        }
    }
    /*
    æ€è·¯ï¼š
    x2=x1+C-1
    y2=y1+C-1
    return s[x2][y2] - s[x2][y1-1] - s[x1-1][y2] + s[x1-1][y1-1];
    */
    int maxVal = -1e9;
    for (int x1 = 1; x1 <= N - C + 1; x1++) { // åƒä¸‡æ³¨æ„æˆªè‡³è¾¹ç•Œ
        for (int y1 = 1; y1 <= M - C + 1; y1++) {
            int temp = s[x1 + C - 1][y1 + C - 1] - s[x1 + C - 1][y1 - 1] - s[x1 - 1][y1 + C - 1] + s[x1 - 1][y1 - 1];
            if (temp > maxVal) {
                maxVal = temp;
                ansX = x1;
                ansY = y1;
            }
        }
    }
    cout << ansX << " " << ansY;
}
```

